<html>
    <head>
        <title>Test Page</title>
    </head>
    <body>
        <div id = "console">
        </div>
        <script type = "text/javascript" src = "../trialtool/lib/jquery/jquery-1.4.2.min.js">
        </script>
        <script type = "text/javascript" src = "../trialtool/js/ConsoleHelper.js">
        </script>
        <script type = "text/javascript">
            /*Pre Requisites*/
            
            window.indexedDB = window.moz_indexedDB;
            var DAO = {};
            
            document.write("Trying to open database ...");
            var request = window.indexedDB.open("BookShop", "My Book Shop Database");
            request.onsuccess = function(event){
                write("Dataase opened");
                DAO.db = event.result;
                DAO.newTransactionObjectStore = function(){
                    try {
                        var transaction = DAO.db.transaction(["BookList"], 0 /*Read-Write*/, 1000 /*Time out in ms*/);
                        transaction.oncomplete = function(e){
                            document.write("===== Transaction Complete");
                        };
                        transaction.onabort = function(e){
                            document.write("===== Transaction Aborted");
                        };
                        var objectStore = transaction.objectStore("BookList");
                        document.write("==== New Transaction", DAO.objectStore);
                        return objectStore;
                    } 
                    catch (e) {
                        write("Could not open objectStore. You may have to create it first");
                        writeError(e);
                    }
                };
                var objectStore = DAO.newTransactionObjectStore();
                DAO.index = objectStore.index("priceIndex");
                var request = DAO.index.openObjectCursor();
                request.onsuccess = function(e){
                    var cursor = e.result;
                    write(cursor.key, cursor.value);
                    cursor["continue"]();
                    
                };
                
            };
        </script>
    </body>
</html>
